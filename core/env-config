#!/bin/sh -Ceu

readonly main=$(progname "$0")

subs=
flags=
for i in "$@"; do
	case $i in
	all)
		subs="$subs $(sub-command-all "$main")"
		;;
	-*)
		flags="$flags $i"
		;;
	*)
		subs="$subs $i"
		;;
	esac
done

PATH=$(progdir "$0")/$main.d:$PATH
for sub in $subs; do
	# shellcheck disable=SC2086
	sub-command "$main" "$sub" $flags
done
